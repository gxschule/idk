<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vokabeltrainer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tesseract.js/4.0.2/tesseract.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        #output, #question { margin-top: 20px; }
        input, button { margin: 10px; }
    </style>
</head>
<body>
    <h1>Vokabeltrainer</h1>
    <input type="file" id="fileInput" accept="image/*">
    <button onclick="processImage()">Bild analysieren</button>
    <div id="output"></div>
    <div id="quiz" style="display:none;">
        <p id="question"></p>
        <input type="text" id="answer">
        <button onclick="checkAnswer()">Antwort prüfen</button>
        <p id="result"></p>
    </div>
    
    <script>
        let vocabList = [];
        
        function processImage() {
            const file = document.getElementById('fileInput').files[0];
            if (!file) return alert("Bitte ein Bild hochladen!");
            
            const reader = new FileReader();
            reader.onload = function() {
                Tesseract.recognize(reader.result, 'deu')
                    .then(({ data: { text } }) => {
                        vocabList = parseText(text);
                        document.getElementById('output').innerText = "Vokabeln erkannt!";
                        startQuiz();
                    })
                    .catch(err => console.error(err));
            };
            reader.readAsDataURL(file);
        }
        
        function parseText(text) {
            return text.split('\n').map(line => {
                const parts = line.split('-');
                return parts.length === 2 ? { de: parts[0].trim(), en: parts[1].trim() } : null;
            }).filter(Boolean);
        }
        
        function startQuiz() {
            if (vocabList.length === 0) return;
            document.getElementById('quiz').style.display = 'block';
            nextQuestion();
        }
        
        function nextQuestion() {
            const randomVocab = vocabList[Math.floor(Math.random() * vocabList.length)];
            document.getElementById('question').innerText = "Übersetze: " + randomVocab.de;
            document.getElementById('question').dataset.answer = randomVocab.en;
            document.getElementById('answer').value = '';
            document.getElementById('result').innerText = '';
        }
        
        function checkAnswer() {
            const userAnswer = document.getElementById('answer').value.trim().toLowerCase();
            const correctAnswer = document.getElementById('question').dataset.answer.toLowerCase();
            if (userAnswer === correctAnswer) {
                document.getElementById('result').innerText = "Richtig!";
            } else {
                document.getElementById('result').innerText = "Falsch! Richtige Antwort: " + correctAnswer;
            }
            setTimeout(nextQuestion, 2000);
        }
    </script>
</body>
</html>
